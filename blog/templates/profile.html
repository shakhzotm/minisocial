<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ü—Ä–æ—Ñ–∏–ª—å {{ profile_user.username }}</title>
  <style>
    :root{
      --bg:#f4f4f9;
      --card-bg:#ffffff;
      --muted:#8a8f98;
      --accent:#007bff;
      --danger:#e0245e;
      --border:rgba(0,0,0,0.08);
      --shadow: 0 6px 20px rgba(24,39,75,0.06);
      --radius:12px;
    }

    *{box-sizing:border-box}
    body{
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      background:var(--bg);
      margin:0;
      color:#222;
      -webkit-font-smoothing:antialiased;
    }

    header{
      background:var(--card-bg);
      padding:14px 28px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      box-shadow:0 1px 0 rgba(0,0,0,0.04);
      position:sticky;
      top:0;
      z-index:50;
    }
    header h1{margin:0;font-size:18px;color:#111}
    header nav a{color:var(--accent); text-decoration:none; margin-left:14px; font-weight:500}
    header nav a:hover{text-decoration:underline}

    main{
      max-width:980px;
      margin:28px auto;
      padding:22px;
    }

    /* –ø—Ä–æ—Ñ–∏–ª—å */
    .profile-card{
      display:flex;
      gap:20px;
      align-items:center;
      background:var(--card-bg);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:18px;
      box-shadow: var(--shadow);
      margin-bottom:22px;
    }

    .profile-avatar{
      width:84px;
      height:84px;
      border-radius:50%;
      background:#ddd;
      background-size:cover;
      background-position:center;
      flex:0 0 84px;
      border:1px solid rgba(0,0,0,0.05);
    }

    .profile-info h2{margin:0 0 6px 0; font-size:20px}
    .profile-meta{color:var(--muted); font-size:14px; margin-bottom:8px}
    .profile-bio{margin:6px 0 0 0; color:#333; line-height:1.4}

    .edit-link{
      margin-top:10px;
      display:inline-block;
      padding:8px 14px;
      background:var(--accent);
      color:#fff;
      border-radius:8px;
      text-decoration:none;
      font-weight:600;
    }
    .edit-link:hover{background:#0062d6}

    /* —Å–µ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤ */
    .posts-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap:18px;
    }

    .post-card{
      background:var(--card-bg);
      border:1px solid var(--border);
      border-radius:12px;
      overflow:hidden;
      box-shadow: 0 4px 14px rgba(22,28,45,0.04);
      transition: transform .15s ease, box-shadow .15s ease;
      display:flex;
      flex-direction:column;
    }
    .post-card:hover{
      transform: translateY(-6px);
      box-shadow: 0 12px 30px rgba(22,28,45,0.08);
    }

    .post-top{
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px 14px;
    }
    .post-top .mini-avatar{
      width:40px; height:40px; border-radius:50%;
      background:#ddd; background-size:cover; background-position:center;
      border:1px solid rgba(0,0,0,0.04);
      flex:0 0 40px;
    }
    .post-author{font-weight:700; color:#111; text-decoration:none}
    .post-author:hover{text-decoration:underline}
    .post-time{color:var(--muted); font-size:12px}

    .post-media{
      width:100%;
      background:#fafafa;
      display:block;
      max-height:360px;
      overflow:hidden;
    }
    .post-media img{
      display:block;
      width:100%;
      height:100%;
      object-fit:cover;
    }

    .post-body{padding:12px 14px; flex:1}
    .post-text{margin:0 0 10px 0; color:#222; line-height:1.45}
    .post-actions{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 14px;
      border-top:1px solid rgba(0,0,0,0.03);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0));
    }

    .like-btn{
      background:none;
      border:1px solid rgba(0,0,0,0.06);
      padding:6px 10px;
      border-radius:8px;
      cursor:pointer;
      color:var(--danger);
      font-weight:600;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .like-btn:hover{transform:scale(1.03)}

    .comments-link{
      color:var(--muted);
      text-decoration:none;
      font-size:14px;
    }

    .no-posts{
      padding:20px;
      text-align:center;
      color:var(--muted);
    }

    @media (max-width:640px){
      .profile-card{flex-direction:column; align-items:flex-start}
      .profile-avatar{width:72px;height:72px}
    }
  </style>
</head>
<body>

<header>
  <h1>–ü—Ä–æ—Ñ–∏–ª—å {{ profile_user.username }}</h1>
  <nav>
    <a href="{% url 'post_list' %}">–õ–µ–Ω—Ç–∞</a>
    <a href="{% url 'create_post' %}">–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</a>
    <a href="{% url 'logout' %}">–í—ã–π—Ç–∏</a>
  </nav>
</header>

<main>
  <!-- –ø—Ä–æ—Ñ–∏–ª—å -->
  <div class="profile-card">
    <div class="profile-avatar"
         {% if profile.avatar %}
           style="background-image: url('{{ profile.avatar.url }}');"
         {% endif %}></div>

    <div class="profile-info">
      <h2>{{ profile_user.get_full_name|default:profile_user.username }}</h2>
      <div class="profile-meta">
        <span><strong>–ì–æ—Ä–æ–¥:</strong> {{ profile.city|default:"‚Äî" }}</span> &nbsp;¬∑&nbsp;
        <span><strong>–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> {{ profile.birth_date|date:"d.m.Y"|default:"‚Äî" }}</span>
      </div>
      <div class="profile-bio">{{ profile.bio|default:"–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–ø–∏—Å–∞–Ω–æ." }}</div>

      {% if request.user == profile_user %}
        <a class="edit-link" href="{% url 'profile_edit' profile_user.username %}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
      {% endif %}
    </div>
  </div>

  <!-- –ø–æ—Å—Ç—ã -->
  <h3 style="margin:6px 0 12px 2px; color:#333;">–ü–æ—Å—Ç—ã {{ profile_user.username }}</h3>

  {% if posts %}
    <div class="posts-grid">
      {% for post in posts %}
        <div class="post-card">
          <div class="post-top">
            <div class="mini-avatar"
                 {% if post.author.profile.avatar %}
                   style="background-image: url('{{ post.author.profile.avatar.url }}');"
                 {% endif %}></div>
            <div>
              <a href="{% url 'profile' post.author.username %}" class="post-author">{{ post.author.username }}</a><br>
              <span class="post-time">{{ post.created_at }}</span>
            </div>
          </div>

          {% if post.image %}
            <div class="post-media">
              <a href="{% url 'post_detail' post.id %}">
                <img src="{{ post.image.url }}" alt="–§–æ—Ç–æ –ø–æ—Å—Ç–∞">
              </a>
            </div>
          {% endif %}

          <div class="post-body">
            <p class="post-text">{{ post.description|linebreaksbr }}</p>
          </div>

          <div class="post-actions">
            <form action="{% url 'like_post' post.id %}" method="post" style="margin:0;">
              {% csrf_token %}
              <button type="submit" class="like-btn">‚ù§Ô∏è {{ post.total_likes }}</button>
            </form>

            <a class="comments-link" href="{% url 'post_detail' post.id %}#comments">–ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="no-posts">–ü–æ—Å—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç üôÉ</div>
  {% endif %}

</main>
</body>
</html>
